<!DOCTYPE html>
<html data-require="math word-problems graphie interactive">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Conditional intuition</title>
    <script src="../khan-exercise.js"></script>
    <style type="text/css">
        .color-error {
            display: none;
            color: red;
        }

        .graphie {
            outline: black solid 2px;
        }
    </style>
</head>
<body>
<div class="exercise">
    <div class="problems">
        <div id="choose-shape">
            <div class="vars">
                <var id="SHAPE">randFromArray(["triangle", "circle", "square"])</var>
                <var id="COLOR">randFromArray(["red", "blue", "green"])</var>
                <var id="TYPE">randRange(0, 3)</var>
                <var id="QUESTION">(TYPE &lt; 2) ? ("a "+SHAPE) : COLOR</var>
            </div>

            <div class="question">
                All <var>SHAPE</var>s must be <var>COLOR</var>.
                <br>
                If an object is <var>(TYPE === 1 || TYPE === 3) ? "not " : ""</var><var>QUESTION</var>,
                    what do we know about its <var>(TYPE &lt; 2) ? "color" : "shape"</var>?
            </div>
            <div class="problem">
                <div>
                    Add Shape:
                    <select id="color">
                        <option>red</option>
                        <option>blue</option>
                        <option>green</option>
                    </select>
                    <select id="shape">
                        <option>triangle</option>
                        <option>square</option>
                        <option>circle</option>
                    </select>
                    <input type="button" value="Add!" onclick="KhanUtil.tmpl.getVAR('currentGraph.graph').addShapeFromSelector(); return false;" />
                    <span class="color-error">Can't have <span id="color-error-shape"></span>s that are <span id="color-error-color"></span></span>
                    <br>
                    <input type="button" value="Sort by Color" onclick="KhanUtil.tmpl.getVAR('currentGraph.graph').sortByColor(); return false;" />
                    <input type="button" value="Sort by Shape" onclick="KhanUtil.tmpl.getVAR('currentGraph.graph').sortByShape(); return false;" />
                </div>
                <div class="graphie">
                    init({ range: [[-1, 21], [-21, 1]], scale: [20, 20] });
                    addMouseLayer();

                    graph.shape = function(x, y, color) {
                        var moveShape = addMovablePoint({
                            coord: [x, y]
                        });
                        moveShape.highlightStyle.scale = 1;
                        moveShape.highlightStyle.fill = color;
                        moveShape.highlightStyle.stroke = "black";

                        moveShape.normalStyle.scale = 1;
                        moveShape.normalStyle.fill = color;
                        moveShape.normalStyle.stroke = "black";

                        moveShape.color = color;

                        return moveShape;
                    }

                    graph.triangle = function(x, y, color) {
                        var myshape = path([[x-0.9, y+1.7], [x-1.6, y+0.6], [x-0.2, y+0.6], true],
                                           {strokeWidth: 2, stroke: "black", fill: color});

                        var shape = graph.shape(x, y, color);

                        shape.visibleShape.remove();
                        shape.visibleShape = myshape;
                        shape.setCoord([x, y]);

                        shape.shape = "triangle";

                        return shape;
                    };

                    graph.square = function(x, y, color) {
                        var myshape = path([[x-1.5, y+0.3], [x-1.5, y+1.5], [x-0.3, y+1.5], [x-0.3, y+0.3], true],
                                           {strokeWidth: 2, stroke: "black", fill: color});

                        var shape = graph.shape(x, y, color);

                        shape.visibleShape.remove();
                        shape.visibleShape = myshape;
                        shape.setCoord([x, y]);

                        shape.shape = "square";

                        return shape;
                    };

                    graph.circle = function(x, y, color) {
                        var myshape = ellipse([-0.9, 0.9], 0.7,
                                           {strokeWidth: 2, stroke: "black", fill: color});

                        var shape = graph.shape(x, y, color);

                        shape.visibleShape.remove();
                        shape.visibleShape = myshape;
                        shape.setCoord([x, y]);

                        shape.shape = "circle";

                        return shape;
                    };

                    graph.shapes = [];

                    graph.addShape = function(shape, color) {
                        if (shape === SHAPE) {
                            color = COLOR;
                        }
                        var newShape = graph[shape](0, 0, color);
                        newShape.setCoord([random() * 20, random() * -20]);
                        graph.shapes.push(newShape);
                    };

                    graph.addShapeFromSelector = function() {
                        var shape = $("#shape option:selected").text();
                        var color = $("#color option:selected").text();
                        if (shape === SHAPE &amp;&amp; color !== COLOR) {
                            $("#color-error-shape").text(shape);
                            $("#color-error-color").text(color);
                            $(".color-error").css("display", "inline");
                        } else {
                            $(".color-error").css("display", "none");
                            graph.addShape(shape, color);
                        }
                    }

                    graph.sortByShape = function() {
                        _.each(graph.shapes, function(e) {
                            var newX = 0;
                            if (e.shape === "square") {
                                newX = [1, 5];
                            } else if (e.shape === "triangle") {
                                newX = [8, 12];
                            } else {
                                newX = [15, 19];
                            }
                            if (e.coord[0] &lt; newX[0] ||
                                e.coord[0] &gt; newX[1]) {
                                e.moveTo(newX[0] + 4 * random(), e.coord[1]);
                            }
                        });
                    }

                    graph.sortByColor = function() {
                        _.each(graph.shapes, function(e) {
                            var newY = 0;
                            if (e.color === "blue") {
                                newY = [-5, -1];
                            } else if (e.color === "red") {
                                newY = [-12, -8];
                            } else {
                                newY = [-19, -15];
                            }
                            if (e.coord[1] &lt; newY[0] ||
                                e.coord[1] &gt; newY[1]) {
                                e.moveTo(e.coord[0], newY[0] + 4 * random());
                            }
                        });
                    }

                    _(5).times(function() {
                        graph.addShape(randFromArray(["triangle", "square", "circle"]),
                                       randFromArray(["red", "blue", "green"]));
                    });
                </div>
            </div>

            <div class="solution" data-type="custom" data-if="TYPE < 2">
                <div class="instruction">
                    <input type="radio" name="answertype" value="deduce" checked />
                        Objects that are <var>SHAPE</var>s<br>
                        <select id="decision-choice">
                            <option>must be</option>
                            <option>must not be</option>
                        </select>
                        <select id="answer-choice">
                            <option>red</option>
                            <option>blue</option>
                            <option>green</option>
                        </select>
                    <br>
                    <input type="radio" name="answertype" value="notdeduce" />
                        We can't be sure of anything
                </div>
                <div class="guess">
                    [ $("#decision-choice option:selected").text(),
                      $("#answer-choice   option:selected").text(),
                      $("input[name=answertype]:checked").val() ]
                </div>
                <div class="validator-function">
                    if (TYPE === 0) {
                        return (guess[0] === "must be") &amp;&amp;
                               (guess[1] === COLOR) &amp;&amp;
                               (guess[2] === "deduce");
                    } else {
                        return (guess[2] === "notdeduce");
                    }
                </div>
                <div class="show-guess-solutionarea">
                    if (guess.length &gt; 0) {
                        $("#decision-choice").val(guess[0]).attr('selected', true);
                        $("#answer-choice").val(guess[1]).attr('selected', true);
                        $("input:radio[name=answertype]").filter("[value="+guess[2]+"]")
                                                         .attr('checked', true);
                    } else {
                        $("#decision-choice").val("must be").attr('selected', true);
                        $("#answer-choice").val("red").attr('selected', true);
                        $("input:radio[name=answertype]").filter("[value=deduce]")
                                                         .attr('checked', true);
                    }
                </div>
            </div>
            <div class="solution" data-type="custom" data-else>
                <div class="instruction">
                    <input type="radio" name="answertype" value="deduce" checked />
                        Objects that are <var>COLOR</var><br>
                        <select id="decision-choice">
                            <option>must be</option>
                            <option>must not be</option>
                        </select>
                        <select id="answer-choice">
                            <option>triangles</option>
                            <option>circles</option>
                            <option>squares</option>
                        </select>
                    <br>
                    <input type="radio" name="answertype" value="notdeduce" />
                        We can't be sure of anything
                </div>
                <div class="guess">
                    [ $("#decision-choice option:selected").text(),
                      $("#answer-choice   option:selected").text(),
                      $("input[name=answertype]:checked").val() ]
                </div>
                <div class="validator-function">
                    if (TYPE === 3) {
                        return (guess[0] === "must not be") &amp;&amp;
                               (guess[1] === SHAPE+"s") &amp;&amp;
                               (guess[2] === "deduce");
                    } else {
                        return (guess[2] === "notdeduce");
                    }
                </div>
                <div class="show-guess-solutionarea">
                    if (guess.length &gt; 0) {
                        $("#decision-choice").val(guess[0]).attr('selected', true);
                        $("#answer-choice").val(guess[1]).attr('selected', true);
                        $("input:radio[name=answertype]").filter("[value="+guess[2]+"]")
                                                         .attr('checked', true);
                    } else {
                        $("#decision-choice").val("must be").attr('selected', true);
                        $("#answer-choice").val("triangle").attr('selected', true);
                        $("input:radio[name=answertype]").filter("[value=deduce]")
                                                         .attr('checked', true);
                    }
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
