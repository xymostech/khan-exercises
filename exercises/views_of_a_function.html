<!DOCTYPE html>
<html data-require="math graphie">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Views of a function</title>
    <script src="../khan-exercise.js"></script>
    <script type="text/javascript">
        chooseXValues = function(func, scale) {
            var xs = [];
            _.each(_.range(-9, 10), function(x) {
                var y = func(x);
                if (Math.abs(y) > 9) {
                    return;
                }
                if (Math.abs(y - Math.round(y * scale) / scale) < 0.1) {
                    xs.push(x);
                }
            });
            return xs;
        };
    </script>
    <style type="text/css">
        #ttable {
            text-align: left;
            margin-top: 30px;
            margin-left: 30px;
        }

        #ttable td {
            padding: 0px 5px;
        }

        #ttable .labels td {
            padding-left: 10px;
            border-bottom: 2px solid black;
        }

        #ttable .cross-bar td {
            padding-top: 5px;
        }

        #ttable .second-col {
            border-left: 2px solid black;
        }
    </style>
</head>
<body>
<div class="exercise">
    <div class="problems">
        <div id="graph-to-table">
            <div class="vars">
                <var id="A">randRange(-3, 3)</var> 
                <var id="B">randRangeNonZero(-3, 3)</var>
                <var id="C">randRangeNonZero(-3, 3)</var>
                <var id="FUNC">randFromArray([
                    function(x) {
                        return B * x + C;
                    },
                    function(x) {
                        return A / 2 * x * x + B * x + C;
                    },
                    function(x) {
                        return A * sin(C * x / Math.PI) + B;
                        },
                    function(x) {
                        return A * pow(Math.E, C * x / 3) + B;
                    }
                ])</var>
                <var id="EXAMPLES">(function() {
                    var xs = chooseXValues(FUNC, 1);
                    if (xs.length &gt;= 5) {
                        return sortNumbers(shuffle(xs, 5));
                    } else {
                        xs = chooseXValues(FUNC, 2);
                        return sortNumbers(shuffle(xs, 5));
                    }
                })()</var>
            </div>

            <p class="question">
                Create a table of values for the function in the graph below.
                Use at least 5 different points.
            </p>
            <div class="problem">
                <div class="graphie" id="main">
                    graphInit({
                        range: 10,
                        scale: 20,
                        tickStep: 1,
                        labelStep: 1,
                        unityLabels: false,
                        labelFormat: function( s ) { return "\\small{" + s + "}"; },
                        axisArrows: "<->"
                    });

                    plot(FUNC, [-10, 10], { stroke: BLUE });
                </div>
            </div>
            <div class="solution" data-type="custom">
                <div class="instruction">
                    <span>Enter your data in the table below.</span>
                    <table id="ttable">
                        <tr class="labels">
                            <td><code>x</code></td>
                            <td class="second-col"><code>y</code></td>
                        </tr>
                        <tr class="cross-bar">
                            <td><input type="text" /></td>
                            <td class="second-col"><input type="text" /></td>
                        </tr>
                        <tr>
                            <td><input type="text" /></td>
                            <td class="second-col"><input type="text" /></td>
                        </tr>
                        <tr>
                            <td><input type="text" /></td>
                            <td class="second-col"><input type="text" /></td>
                        </tr>
                        <tr>
                            <td><input type="text" /></td>
                            <td class="second-col"><input type="text" /></td>
                        </tr>
                        <tr>
                            <td><input type="text" /></td>
                            <td class="second-col"><input type="text" /></td>
                        </tr>
                        <tr>
                            <td><input type="text" /></td>
                            <td class="second-col"><input type="text" /></td>
                        </tr>
                        <tr>
                            <td><input type="text" /></td>
                            <td class="second-col"><input type="text" /></td>
                        </tr>
                    </table>
                </div>
                <div class="guess">
                    (function(){
                        var guess = [];
                        $("#ttable tr").each(function() {
                            var input = [];
                            $(this).children().each(function() {
                                input.push($(this).children().val());
                            });
                            guess.push(input);
                        });
                        return guess;
                    })()
                </div>
                <div class="validator-function">
                    var attempted = 0;
                    var correct = 0;
                    var xs = [];

                    for (var i = 0; i &lt; 8; ++i) {
                        if ($.trim(guess[i][0]) !== "" &amp;&amp;
                            $.trim(guess[i][1]) !== "") {
                            attempted += 1;

                            var x = parseFloat(guess[i][0]), y = parseFloat(guess[i][1]);

                            if (abs(FUNC(x) - y) &lt; 0.5) {
                                correct += 1;
                                xs.push(x);
                            }
                        }
                    }

                    if (attempted &lt; 5) {
                        return "You must enter 5 or more points";
                    }

                    xs = KhanUtil.sortNumbers(xs);
                    var different = 1;

                    for (var i = 0; i &lt; correct - 1; ++i) {
                        if (xs[i + 1] - xs[i] &gt;= 0.5) {
                            different += 1;
                        }
                    }

                    return different === attempted;
                </div>
            </div>

            <div class="hints">
                <p>You can represent a function in multiple ways. Here, we have a function represented as a graph, and we want to represent it as a table.</p>
                <p>To represent it as a table, take any five points on the graph, and list them in the table.</p>
                <p>For example, we can look at the point with an <code>x</code>-value of <code><var>EXAMPLES[0]</var></code>.</p>
                <div>
                    <p>The <code>y</code>-value at this point is <code><var>round(2 * FUNC(EXAMPLES[0])) / 2</var></code>, which we find from the graph.</p>
                    <div class="graphie" data-update="main">
                        line([EXAMPLES[0], -11], [EXAMPLES[0], 11], { strokeWidth: 1, stroke: ORANGE });
                        circle([EXAMPLES[0], FUNC(EXAMPLES[0])], 0.2, { stroke: ORANGE, fill: ORANGE });
                    </div>
                </div>
                <p>To record this in our table, put <code><var>EXAMPLES[0]</var></code> in the <code>x</code> column, and <code><var>round(2 * FUNC(EXAMPLES[0])) / 2</var></code> in the <code>y</code> column.</p>
                <p>We can do this with 4 other <code>x</code>-values, such as <code><var>EXAMPLES[1]</var></code>, <code><var>EXAMPLES[2]</var></code>, <code><var>EXAMPLES[3]</var></code>, and <code><var>EXAMPLES[4]</var></code>.</p>
                <div>
                    <p>We can find the <code>y</code>-values at these points by finding them on the graph as well.</p>
                    <div class="graphie" data-update="main">
                        for (var i = 1; i &lt; 5; ++i) {
                            line([EXAMPLES[i], -11], [EXAMPLES[i], 11], { strokeWidth: 1, stroke: ORANGE });
                            circle([EXAMPLES[i], FUNC(EXAMPLES[i])], 0.2, { stroke: ORANGE, fill: ORANGE });
                        }
                    </div>
                </div>
                <div>
                    <p>From this, five points on the graph are:</p>
                    <div data-each="EXAMPLES as x">
                        <p><code>(<var>x</var>, <var>round(FUNC(x) * 2) / 2</var>)</code></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
